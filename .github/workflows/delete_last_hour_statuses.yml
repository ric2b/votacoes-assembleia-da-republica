name: Delete statuses from last hour
run-name: ${{ github.actor }} is deleting statuses for the last hour
on:
  workflow_dispatch:
    inputs:
      last_n_hours:
        description: 'Since how many hours ago'
        required: true
        default: 1

jobs:
  Delete-Statuses:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - run: pipx install poetry
      - uses: actions/setup-python@v5
        with:
          python-version: '3.12'
          cache: 'poetry'
      - run: poetry install
      - name: List working directory
        run:  echo "${{ github.workspace }}"
      - name: Delete statuses
        run: poetry run python3 delete_statuses.py ${{ github.event.inputs.last_n_hours }}
        env: # Or as an environment variable
          MASTODON_ACCESS_TOKEN: ${{ secrets.MASTODON_ACCESS_TOKEN }}
      - run: echo "üçè This job's status is ${{ job.status }}."
